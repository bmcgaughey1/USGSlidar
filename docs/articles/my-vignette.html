<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>USGSlidar -- Basics • USGSlidar</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="USGSlidar -- Basics">
<meta property="og:description" content="USGSlidar">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">USGSlidar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/my-vignette.html">USGSlidar -- Basics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="my-vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>USGSlidar – Basics</h1>
                        <h4 class="author">Robert J. McGaughey</h4>
            
            <h4 class="date">2021-06-04</h4>
      
      
      <div class="hidden name"><code>my-vignette.Rmd</code></div>

    </div>

    
    
<div id="overall-goal" class="section level1">
<h1 class="hasAnchor">
<a href="#overall-goal" class="anchor"></a>Overall Goal</h1>
<p>The USGSlidar package was developed to make it somewhat easy to query the collection of lidar data available from the U.S. Geological Survey’s 3D Elevation Program (and other sources) to find out if data are available for specific locations of interest. The package accesses some of the project and tile index files available from 3DEP and uses them to search for data. The package also provides links to lidar data files that can be downloaded for free directly from 3DEP servers.</p>
<p>The package also facilitates access to the USGS lidar collection maintained in Entwine format. This collection contains a subset of the data available from USGS but it is constantly being updated to match the data available in the national map. The index for the Entwine collection does not contain detailed project information so there is extra effort required to marry the Entwine index with information in the USGS 3DEP collection.</p>
<div id="packages" class="section level2">
<h2 class="hasAnchor">
<a href="#packages" class="anchor"></a>Packages</h2>
<p>Load the packages needed for the examples.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/ggspatial/">ggspatial</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">USGSlidar</span><span class="op">)</span></code></pre></div>
</div>
<div id="example-1-query-usgs-entwine-lidar-collection" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1-query-usgs-entwine-lidar-collection" class="anchor"></a>Example 1 – Query USGS Entwine lidar collection</h2>
<p>Using the USGS Entwine data collection, query for coverage for a buffered point location. The Entwine data collection is in the web mercator projection (EPSG:3857). The point coordinate is also in the web mercator projection. The point is buffered using a circular buffer with a radius of 500m.</p>
<p>The Entwine data collection can be accessed using PDAL to retrieve data for specific areas of interest without needing to know the structure of the data (tile arrangement or tile naming). Unfortunately, the Entwine index file contains very few details for each acquisition so it is hard to find data for specific years. Other USGS data collection contain this information. I have developed R code that matches index files from the data hosted on the rockyftp server with the projects in the Entwine collection to produce a new index file that can be used with the <strong>USGSlidar</strong> package. This index is hosted <a href="https://raw.githubusercontent.com/bmcgaughey1/EntwineIndex/main/Index/ENTWINEBoundaries.gpkg%22">here</a>. The second example uses this enhanced index.</p>
<p>The example point is located within the 2014 Glacier Peak lidar acquisition in Washington state, USA.</p>
<p><strong>This example will download the <a href="https://raw.githubusercontent.com/hobu/usgs-lidar/master/boundaries/resources.geojson">Entwine index</a> produced by Howard Butler into the current working directory.</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># retrieve the entwine boundary index and store in current directory</span>
<span class="fu"><a href="../reference/fetchUSGSProjectIndex.html">fetchUSGSProjectIndex</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"ENTWINE"</span><span class="op">)</span>

<span class="co"># query to find the project polygon(s) that covers the buffered point</span>
<span class="co"># the return value is the project area polygon(s) that intersect buffered point</span>
<span class="va">project_polys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/queryUSGSProjectIndex.html">queryUSGSProjectIndex</a></span><span class="op">(</span><span class="op">-</span><span class="fl">13499097</span>
                                       , <span class="fl">6139669</span>
                                       , buffer <span class="op">=</span> <span class="fl">500</span>
                                       , shape <span class="op">=</span> <span class="st">"circle"</span>
                                       , crs <span class="op">=</span> <span class="st">"EPSG:3857"</span>
<span class="op">)</span>

<span class="co"># now query to get the sample area attributed with the project polygon information</span>
<span class="co"># this is the same call as above but with return="aoi"</span>
<span class="va">point_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/queryUSGSProjectIndex.html">queryUSGSProjectIndex</a></span><span class="op">(</span><span class="op">-</span><span class="fl">13499097</span>
                                    , <span class="fl">6139669</span>
                                    , buffer <span class="op">=</span> <span class="fl">500</span>
                                    , shape <span class="op">=</span> <span class="st">"circle"</span>
                                    , return <span class="op">=</span> <span class="st">"aoi"</span>
                                    , crs <span class="op">=</span> <span class="st">"EPSG:3857"</span>
<span class="op">)</span>
<span class="co">#&gt; Using pre-loaded project index</span>

<span class="co"># finally, query using a point in UTM 10N within the same lidar acquisition to attribute</span>
<span class="co"># the point with lidar project information. return point will be in web mercator projection.</span>
<span class="va">point</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/queryUSGSProjectIndex.html">queryUSGSProjectIndex</a></span><span class="op">(</span><span class="fl">640377.7</span>
                                , <span class="fl">5330460</span>
                                , buffer <span class="op">=</span> <span class="fl">0</span>
                                , shape <span class="op">=</span> <span class="st">"circle"</span>
                                , return <span class="op">=</span> <span class="st">"aoi"</span>
                                , crs <span class="op">=</span> <span class="st">"EPSG:26910"</span>
                                , returncrs <span class="op">=</span> <span class="st">"EPSG:3857"</span>
<span class="op">)</span>
<span class="co">#&gt; Using pre-loaded project index</span>

<span class="co"># display the project area polygon and the buffered point</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"2014 Glacier Peak lidar acquisition"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_map_tile.html">annotation_map_tile</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"osm"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html">layer_spatial</a></span><span class="op">(</span><span class="va">project_polys</span>, fill <span class="op">=</span> <span class="st">"cornsilk"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html">layer_spatial</a></span><span class="op">(</span><span class="va">point</span>, col <span class="op">=</span> <span class="st">"green"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html">annotation_spatial</a></span><span class="op">(</span><span class="va">point_poly</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-2-1.png" width="576"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Attributes for the acquistion in the ENTWINE index:\n"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">project_polys</span><span class="op">@</span><span class="va">data</span><span class="op">)</span>, collapse<span class="op">=</span> <span class="st">"\n "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Attributes for the acquistion in the ENTWINE index:</span>
<span class="co">#&gt;  name</span>
<span class="co">#&gt;  id</span>
<span class="co">#&gt;  count</span>
<span class="co">#&gt;  url</span></code></pre></div>
</div>
<div id="example-2-query-usgs-entwine-lidar-collection-using-enhanced-entwine-index" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2-query-usgs-entwine-lidar-collection-using-enhanced-entwine-index" class="anchor"></a>Example 2 – Query USGS Entwine lidar collection using enhanced ENTWINE index</h2>
<p>This example is identical to Example 1 except it uses the enhanced index for ENTWINE data that includes information about the acquisition including the start and end dates for data collection. Using this index, you can search for data covering specific dates for a given location.</p>
<p><strong>This example will download the <a href="https://raw.githubusercontent.com/bmcgaughey1/EntwineIndex/main/Index/ENTWINEBoundaries.gpkg">Enhanced Entwine index</a> produced by Robert J. McGaughey into the current working directory.</strong></p>
<p>Be sure to look at the output below the map to see the additional columns of information available in the enhanced index.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># retrieve the enhanced entwine boundary index and store in current directory</span>
<span class="fu"><a href="../reference/fetchUSGSProjectIndex.html">fetchUSGSProjectIndex</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"ENTWINEPLUS"</span><span class="op">)</span>

<span class="co"># query to find the project polygon(s) that covers the buffered point</span>
<span class="co"># the return value is the project area polygon(s) that intersect buffered point</span>
<span class="va">project_polys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/queryUSGSProjectIndex.html">queryUSGSProjectIndex</a></span><span class="op">(</span><span class="op">-</span><span class="fl">13499097</span>
                                       , <span class="fl">6139669</span>
                                       , buffer <span class="op">=</span> <span class="fl">500</span>
                                       , shape <span class="op">=</span> <span class="st">"circle"</span>
                                       , crs <span class="op">=</span> <span class="st">"EPSG:3857"</span>
<span class="op">)</span>

<span class="co"># now query to get the sample area attributed with the project polygon information</span>
<span class="co"># this is the same call as above but with return="aoi"</span>
<span class="va">point_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/queryUSGSProjectIndex.html">queryUSGSProjectIndex</a></span><span class="op">(</span><span class="op">-</span><span class="fl">13499097</span>
                                    , <span class="fl">6139669</span>
                                    , buffer <span class="op">=</span> <span class="fl">500</span>
                                    , shape <span class="op">=</span> <span class="st">"circle"</span>
                                    , return <span class="op">=</span> <span class="st">"aoi"</span>
                                    , crs <span class="op">=</span> <span class="st">"EPSG:3857"</span>
<span class="op">)</span>
<span class="co">#&gt; Using pre-loaded project index</span>

<span class="co"># finally, query using a point in UTM 10N within the same lidar acquisition to attribute</span>
<span class="co"># the point with lidar project information. return point will be in web mercator projection.</span>
<span class="va">point</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/queryUSGSProjectIndex.html">queryUSGSProjectIndex</a></span><span class="op">(</span><span class="fl">640377.7</span>
                                , <span class="fl">5330460</span>
                                , buffer <span class="op">=</span> <span class="fl">0</span>
                                , shape <span class="op">=</span> <span class="st">"circle"</span>
                                , return <span class="op">=</span> <span class="st">"aoi"</span>
                                , crs <span class="op">=</span> <span class="st">"EPSG:26910"</span>
                                , returncrs <span class="op">=</span> <span class="st">"EPSG:3857"</span>
<span class="op">)</span>
<span class="co">#&gt; Using pre-loaded project index</span>

<span class="co"># display the project area polygon and the buffered point</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"2014 Glacier Peak lidar acquisition"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_map_tile.html">annotation_map_tile</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"osm"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html">layer_spatial</a></span><span class="op">(</span><span class="va">project_polys</span>, fill <span class="op">=</span> <span class="st">"cornsilk"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html">layer_spatial</a></span><span class="op">(</span><span class="va">point</span>, col <span class="op">=</span> <span class="st">"green"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html">annotation_spatial</a></span><span class="op">(</span><span class="va">point_poly</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Attributes for the acquistion in the enhanced ENTWINE index:\n"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">project_polys</span><span class="op">@</span><span class="va">data</span><span class="op">)</span>, collapse<span class="op">=</span> <span class="st">"\n "</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Attributes for the acquistion in the enhanced ENTWINE index:</span>
<span class="co">#&gt;  name</span>
<span class="co">#&gt;  id</span>
<span class="co">#&gt;  count</span>
<span class="co">#&gt;  url</span>
<span class="co">#&gt;  ENTpid</span>
<span class="co">#&gt;  SEQ</span>
<span class="co">#&gt;  MatchMethod</span>
<span class="co">#&gt;  workunit</span>
<span class="co">#&gt;  workunit_id</span>
<span class="co">#&gt;  workpackage</span>
<span class="co">#&gt;  workpackage_id</span>
<span class="co">#&gt;  collect_start</span>
<span class="co">#&gt;  collect_end</span>
<span class="co">#&gt;  ql</span>
<span class="co">#&gt;  spec</span>
<span class="co">#&gt;  p_method</span>
<span class="co">#&gt;  dem_gsd_meters</span>
<span class="co">#&gt;  horiz_crs</span>
<span class="co">#&gt;  vert_crs</span>
<span class="co">#&gt;  lpc_pub_date</span>
<span class="co">#&gt;  lpc_category</span>
<span class="co">#&gt;  lpc_reason</span>
<span class="co">#&gt;  opr_pub_date</span>
<span class="co">#&gt;  opr_category</span>
<span class="co">#&gt;  opr_reason</span>
<span class="co">#&gt;  onemeter_category</span>
<span class="co">#&gt;  onemeter_reason</span>
<span class="co">#&gt;  seamless_category</span>
<span class="co">#&gt;  seamless_reason</span>
<span class="co">#&gt;  lpc_link</span>
<span class="co">#&gt;  opr_link</span>
<span class="co">#&gt;  metadata_link</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robert McGaughey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
